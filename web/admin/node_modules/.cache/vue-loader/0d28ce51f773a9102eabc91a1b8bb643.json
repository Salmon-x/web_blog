{"remainingRequest":"/Users/salmon/go/src/我的博客/blog/web/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/salmon/go/src/我的博客/blog/web/admin/src/components/article/ArtList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/salmon/go/src/我的博客/blog/web/admin/src/components/article/ArtList.vue","mtime":1627027138099},{"path":"/Users/salmon/go/src/我的博客/blog/web/admin/node_modules/cache-loader/dist/cjs.js","mtime":1627027136676},{"path":"/Users/salmon/go/src/我的博客/blog/web/admin/node_modules/babel-loader/lib/index.js","mtime":1627027136623},{"path":"/Users/salmon/go/src/我的博客/blog/web/admin/node_modules/cache-loader/dist/cjs.js","mtime":1627027136676},{"path":"/Users/salmon/go/src/我的博客/blog/web/admin/node_modules/vue-loader/lib/index.js","mtime":1627027137970}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBkYXkgZnJvbSAnZGF5anMnCgpjb25zdCBjb2x1bW5zID0gWwogIHsKICAgIHRpdGxlOiAnSUQnLAogICAgZGF0YUluZGV4OiAnSUQnLAogICAgd2lkdGg6ICc1JScsCiAgICBrZXk6ICdpZCcsCiAgICBhbGlnbjogJ2NlbnRlcicsCiAgfSwKICB7CiAgICB0aXRsZTogJ+abtOaWsOaXpeacnycsCiAgICBkYXRhSW5kZXg6ICdVcGRhdGVkQXQnLAogICAgd2lkdGg6ICcxMCUnLAogICAga2V5OiAnVXBkYXRlZEF0JywKICAgIGFsaWduOiAnY2VudGVyJywKICAgIGN1c3RvbVJlbmRlcjogKHZhbCkgPT4gewogICAgICByZXR1cm4gdmFsID8gZGF5KHZhbCkuZm9ybWF0KCdZWVlZ5bm0TU3mnIhEROaXpSBISDptbScpIDogJ+aaguaXoCcKICAgIH0sCiAgfSwKICB7CiAgICB0aXRsZTogJ+WIhuexuycsCiAgICBkYXRhSW5kZXg6ICdDYXRlZ29yeS5uYW1lJywKICAgIHdpZHRoOiAnNSUnLAogICAga2V5OiAnbmFtZScsCiAgICBhbGlnbjogJ2NlbnRlcicsCiAgfSwKICB7CiAgICB0aXRsZTogJ+aWh+eroOagh+mimCcsCiAgICBkYXRhSW5kZXg6ICd0aXRsZScsCiAgICB3aWR0aDogJzE1JScsCiAgICBrZXk6ICd0aXRsZScsCiAgICBhbGlnbjogJ2NlbnRlcicsCiAgfSwKICB7CiAgICB0aXRsZTogJ+aWh+eroOaPj+i/sCcsCiAgICBkYXRhSW5kZXg6ICdkZXNjJywKICAgIHdpZHRoOiAnMjAlJywKICAgIGtleTogJ2Rlc2MnLAogICAgYWxpZ246ICdjZW50ZXInLAogIH0sCiAgewogICAgdGl0bGU6ICfnvKnnlaXlm74nLAogICAgZGF0YUluZGV4OiAnaW1nJywKICAgIHdpZHRoOiAnMjAlJywKICAgIGtleTogJ2ltZycsCiAgICBhbGlnbjogJ2NlbnRlcicsCiAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICdpbWcnIH0sCiAgfSwKICB7CiAgICB0aXRsZTogJ+aTjeS9nCcsCiAgICB3aWR0aDogJzE1JScsCiAgICBrZXk6ICdhY3Rpb24nLAogICAgYWxpZ246ICdjZW50ZXInLAogICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAnYWN0aW9uJyB9LAogIH0sCl0KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcGFnaW5hdGlvbjogewogICAgICAgIHBhZ2VTaXplT3B0aW9uczogWyc1JywgJzEwJywgJzIwJ10sCiAgICAgICAgcGFnZVNpemU6IDUsCiAgICAgICAgdG90YWw6IDAsCiAgICAgICAgc2hvd1NpemVDaGFuZ2VyOiB0cnVlLAogICAgICAgIHNob3dUb3RhbDogKHRvdGFsKSA9PiBg5YWxJHt0b3RhbH3mnaFgLAogICAgICB9LAogICAgICBBcnRsaXN0OiBbXSwKICAgICAgQ2F0ZWxpc3Q6IFtdLAogICAgICBjb2x1bW5zLAogICAgICBxdWVyeVBhcmFtOiB7CiAgICAgICAgdGl0bGU6ICcnLAogICAgICAgIHBhZ2VzaXplOiA1LAogICAgICAgIHBhZ2VudW06IDEsCiAgICAgIH0sCiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewoJCXRoaXMuZ2V0Q2F0ZUxpc3QoKQogICAgdGhpcy5nZXRBcnRMaXN0KCkKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOiOt+WPluaWh+eroOWIl+ihqAogICAgYXN5bmMgZ2V0QXJ0TGlzdCgpIHsKICAgICAgY29uc3QgeyBkYXRhOiByZXMgfSA9IGF3YWl0IHRoaXMuJGh0dHAuZ2V0KCdhcGkvdjEvYXJ0aWNsZS8nLCB7CiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICB0aXRsZTogdGhpcy5xdWVyeVBhcmFtLnRpdGxlLAogICAgICAgICAgc2l6ZTogdGhpcy5xdWVyeVBhcmFtLnBhZ2VzaXplLAogICAgICAgICAgcGFnZTogdGhpcy5xdWVyeVBhcmFtLnBhZ2VudW0sCiAgICAgICAgfSwKICAgICAgfSkKICAgICAgaWYgKHJlcy5jb2RlICE9PSAyMDApIHsKICAgICAgICBpZiAocmVzLmNvZGUgPT09IDEwMDQgfHwgMTAwNSB8fCAxMDA2IHx8IDEwMDcpIHsKICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5jbGVhcigpCiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL2xvZ2luJykKICAgICAgICB9CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubWVzc2FnZSkKICAgICAgfQoJCQl0aGlzLkFydGxpc3QgPSByZXMuZGF0YQogICAgICB0aGlzLnBhZ2luYXRpb24udG90YWwgPSByZXMudG90YWwKICAgIH0sCiAgICAvLyDojrflj5bliIbnsbsKICAgIGFzeW5jIGdldENhdGVMaXN0KCkgewogICAgICBjb25zdCB7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kaHR0cC5nZXQoJ2FwaS92MS9jYXRlZ29yeS8nLHtwYXJhbXM6IHsKICAgICAgICAgIHNpemU6IDEwMCwKICAgICAgICAgIHBhZ2U6IDEsCiAgICAgICAgfSx9KQogICAgICBpZiAocmVzLmNvZGUgIT09IDIwMCkgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1zZykKICAgICAgdGhpcy5DYXRlbGlzdCA9IHJlcy5kYXRhCiAgICAgIHRoaXMucGFnaW5hdGlvbi50b3RhbCA9IHJlcy50b3RhbAogICAgfSwKICAgIC8vIOabtOaUueWIhumhtQogICAgaGFuZGxlVGFibGVDaGFuZ2UocGFnaW5hdGlvbiwgZmlsdGVycywgc29ydGVyKSB7CiAgICAgIHZhciBwYWdlciA9IHsgLi4udGhpcy5wYWdpbmF0aW9uIH0KICAgICAgcGFnZXIuY3VycmVudCA9IHBhZ2luYXRpb24uY3VycmVudAogICAgICBwYWdlci5wYWdlU2l6ZSA9IHBhZ2luYXRpb24ucGFnZVNpemUKICAgICAgdGhpcy5xdWVyeVBhcmFtLnBhZ2VzaXplID0gcGFnaW5hdGlvbi5wYWdlU2l6ZQogICAgICB0aGlzLnF1ZXJ5UGFyYW0ucGFnZW51bSA9IHBhZ2luYXRpb24uY3VycmVudAoKICAgICAgaWYgKHBhZ2luYXRpb24ucGFnZVNpemUgIT09IHRoaXMucGFnaW5hdGlvbi5wYWdlU2l6ZSkgewogICAgICAgIHRoaXMucXVlcnlQYXJhbS5wYWdlbnVtID0gMQogICAgICAgIHBhZ2VyLmN1cnJlbnQgPSAxCiAgICAgIH0KICAgICAgdGhpcy5wYWdpbmF0aW9uID0gcGFnZXIKICAgICAgdGhpcy5nZXRBcnRMaXN0KCkKICAgIH0sCiAgICAvLyDliKDpmaTmlofnq6AKICAgIGFzeW5jIGRlbGV0ZUFydChpZCkgewoJCQljb25zdCB7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kaHR0cC5kZWxldGUoYGFwaS9hZG1pbi9hcnRpY2xlLyR7aWR9L2ApCgkJCWlmIChyZXMuY29kZSAhPSAyMDApIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpCgkJCXRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5Yig6Zmk5oiQ5YqfJykKCQkJdGhpcy5xdWVyeVBhcmFtLnBhZ2VudW0gPSAxCgkJCXRoaXMuZ2V0QXJ0TGlzdCgpCgogICAgfSwKICAgIC8vIOafpeivouWIhuexu+S4i+eahOaWh+eroAogICAgQ2F0ZUNoYW5nZSh2YWx1ZSkgewogICAgICB0aGlzLmdldENhdGVBcnQodmFsdWUpCiAgICB9LAogICAgYXN5bmMgZ2V0Q2F0ZUFydChpZCkgewogICAgICBjb25zdCB7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kaHR0cC5nZXQoYGFwaS92MS9jYXRlbGlzdC8ke2lkfS9gLCB7CiAgICAgICAgcGFyYW1zOiB7IHNpemU6IHRoaXMucXVlcnlQYXJhbS5wYWdlc2l6ZSwgcGFnZTogdGhpcy5xdWVyeVBhcmFtLnBhZ2VudW0gfSwKICAgICAgfSkKICAgICAgaWYgKHJlcy5jb2RlICE9PSAyMDApIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpCiAgICAgIHRoaXMuQXJ0bGlzdCA9IHJlcy5kYXRhCiAgICAgIHRoaXMucGFnaW5hdGlvbi50b3RhbCA9IHJlcy50b3RhbAogICAgfSwKICB9LAp9Cg=="},{"version":3,"sources":["ArtList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8DA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ArtList.vue","sourceRoot":"src/components/article","sourcesContent":["<template>\n  <div>\n    <a-card>\n      <a-row :gutter=\"20\">\n        <a-col :span=\"6\">\n          <a-input-search\n            v-model=\"queryParam.title\"\n            placeholder=\"输入文章名查找\"\n            enter-button\n            allowClear\n            @search=\"getArtList\"\n          />\n        </a-col>\n        <a-col :span=\"4\">\n          <a-button type=\"primary\" @click=\"$router.push('addart')\">新增</a-button>\n        </a-col>\n\n        <a-col :span=\"3\">\n          <a-select placeholder=\"请选择分类\" style=\"width: 200px\" @change=\"CateChange\">\n            <a-select-option\n              v-for=\"item in Catelist\"\n              :key=\"item.id\"\n              :value=\"item.id\"\n            >{{ item.name }}</a-select-option>\n          </a-select>\n        </a-col>\n        <a-col :span=\"1\">\n          <a-button type=\"info\" @click=\"getArtList()\">显示全部</a-button>\n        </a-col>\n      </a-row>\n\n      <a-table\n        rowKey=\"ID\"\n        :columns=\"columns\"\n        :pagination=\"pagination\"\n        :dataSource=\"Artlist\"\n        bordered\n        @change=\"handleTableChange\"\n      >\n        <span class=\"ArtImg\" slot=\"img\" slot-scope=\"img\">\n          <img :src=\"'http://localhost:8081/'+img\" />\n        </span>\n        <template slot=\"action\" slot-scope=\"data\">\n          <div class=\"actionSlot\">\n            <a-button\n              size=\"small\"\n              type=\"primary\"\n              icon=\"edit\"\n              style=\"margin-right: 15px\"\n              @click=\"$router.push(`addart/${data.ID}`)\"\n            >编辑</a-button>\n\t\t\t\t\t\t<a-popconfirm title=\"确认删除？删除后无法恢复\" ok-text=\"确认\" cancel-text=\"取消\" @confirm=\"deleteArt(data.ID)\">\n\t\t\t\t  \t\t<a-button icon=\"delete\" size=\"small\" type=\"danger\">删除</a-button>\n\t\t\t\t\t\t</a-popconfirm>\n          </div>\n        </template>\n      </a-table>\n    </a-card>\n  </div>\n</template>\n\n<script>\nimport day from 'dayjs'\n\nconst columns = [\n  {\n    title: 'ID',\n    dataIndex: 'ID',\n    width: '5%',\n    key: 'id',\n    align: 'center',\n  },\n  {\n    title: '更新日期',\n    dataIndex: 'UpdatedAt',\n    width: '10%',\n    key: 'UpdatedAt',\n    align: 'center',\n    customRender: (val) => {\n      return val ? day(val).format('YYYY年MM月DD日 HH:mm') : '暂无'\n    },\n  },\n  {\n    title: '分类',\n    dataIndex: 'Category.name',\n    width: '5%',\n    key: 'name',\n    align: 'center',\n  },\n  {\n    title: '文章标题',\n    dataIndex: 'title',\n    width: '15%',\n    key: 'title',\n    align: 'center',\n  },\n  {\n    title: '文章描述',\n    dataIndex: 'desc',\n    width: '20%',\n    key: 'desc',\n    align: 'center',\n  },\n  {\n    title: '缩略图',\n    dataIndex: 'img',\n    width: '20%',\n    key: 'img',\n    align: 'center',\n    scopedSlots: { customRender: 'img' },\n  },\n  {\n    title: '操作',\n    width: '15%',\n    key: 'action',\n    align: 'center',\n    scopedSlots: { customRender: 'action' },\n  },\n]\n\nexport default {\n  data() {\n    return {\n      pagination: {\n        pageSizeOptions: ['5', '10', '20'],\n        pageSize: 5,\n        total: 0,\n        showSizeChanger: true,\n        showTotal: (total) => `共${total}条`,\n      },\n      Artlist: [],\n      Catelist: [],\n      columns,\n      queryParam: {\n        title: '',\n        pagesize: 5,\n        pagenum: 1,\n      },\n    }\n  },\n  created() {\n\t\tthis.getCateList()\n    this.getArtList()\n  },\n  methods: {\n    // 获取文章列表\n    async getArtList() {\n      const { data: res } = await this.$http.get('api/v1/article/', {\n        params: {\n          title: this.queryParam.title,\n          size: this.queryParam.pagesize,\n          page: this.queryParam.pagenum,\n        },\n      })\n      if (res.code !== 200) {\n        if (res.code === 1004 || 1005 || 1006 || 1007) {\n          window.sessionStorage.clear()\n          this.$router.push('/login')\n        }\n        this.$message.error(res.message)\n      }\n\t\t\tthis.Artlist = res.data\n      this.pagination.total = res.total\n    },\n    // 获取分类\n    async getCateList() {\n      const { data: res } = await this.$http.get('api/v1/category/',{params: {\n          size: 100,\n          page: 1,\n        },})\n      if (res.code !== 200) return this.$message.error(res.msg)\n      this.Catelist = res.data\n      this.pagination.total = res.total\n    },\n    // 更改分页\n    handleTableChange(pagination, filters, sorter) {\n      var pager = { ...this.pagination }\n      pager.current = pagination.current\n      pager.pageSize = pagination.pageSize\n      this.queryParam.pagesize = pagination.pageSize\n      this.queryParam.pagenum = pagination.current\n\n      if (pagination.pageSize !== this.pagination.pageSize) {\n        this.queryParam.pagenum = 1\n        pager.current = 1\n      }\n      this.pagination = pager\n      this.getArtList()\n    },\n    // 删除文章\n    async deleteArt(id) {\n\t\t\tconst { data: res } = await this.$http.delete(`api/admin/article/${id}/`)\n\t\t\tif (res.code != 200) return this.$message.error(res.msg)\n\t\t\tthis.$message.success('删除成功')\n\t\t\tthis.queryParam.pagenum = 1\n\t\t\tthis.getArtList()\n\n    },\n    // 查询分类下的文章\n    CateChange(value) {\n      this.getCateArt(value)\n    },\n    async getCateArt(id) {\n      const { data: res } = await this.$http.get(`api/v1/catelist/${id}/`, {\n        params: { size: this.queryParam.pagesize, page: this.queryParam.pagenum },\n      })\n      if (res.code !== 200) return this.$message.error(res.msg)\n      this.Artlist = res.data\n      this.pagination.total = res.total\n    },\n  },\n}\n</script>\n\n<style scoped>\n.actionSlot {\n  display: flex;\n  justify-content: center;\n}\n.ArtImg {\n  height: 100%;\n  width: 100%;\n}\n\n.ArtImg img {\n  width: 100px;\n  height: 80px;\n}\n</style>\n"]}]}