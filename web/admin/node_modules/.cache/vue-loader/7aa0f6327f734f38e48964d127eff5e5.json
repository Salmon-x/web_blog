{"remainingRequest":"/Users/salmon/go/src/我的博客/blog/web/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/salmon/go/src/我的博客/blog/web/admin/src/components/user/UserList.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/salmon/go/src/我的博客/blog/web/admin/src/components/user/UserList.vue","mtime":1627027138116},{"path":"/Users/salmon/go/src/我的博客/blog/web/admin/node_modules/css-loader/dist/cjs.js","mtime":1627027136907},{"path":"/Users/salmon/go/src/我的博客/blog/web/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1627027137970},{"path":"/Users/salmon/go/src/我的博客/blog/web/admin/node_modules/postcss-loader/src/index.js","mtime":1627027137481},{"path":"/Users/salmon/go/src/我的博客/blog/web/admin/node_modules/cache-loader/dist/cjs.js","mtime":1627027136676},{"path":"/Users/salmon/go/src/我的博客/blog/web/admin/node_modules/vue-loader/lib/index.js","mtime":1627027137970}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouYWN0aW9uU2xvdHsKCWRpc3BsYXk6IGZsZXg7CglqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKfQoK"},{"version":3,"sources":["UserList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6WA;AACA;AACA;AACA","file":"UserList.vue","sourceRoot":"src/components/user","sourcesContent":["<template>\n\t<div>\n\t\t<a-card>\n\t\t\t<a-row :gutter=\"20\">\n\t\t\t\t<a-col :span=\"6\">\n\t\t\t\t\t<a-input-search \n\t\t\t\t\tv-model=\"queryParam.username\"\n\t\t\t\t\tallowClear placeholder=\"请输入用户名\" \n\t\t\t\t\tenter-button \n\t\t\t\t\t@search=\"getUserList\" />\n\t\t\t\t</a-col>\n\t\t\t\t<a-col :span=\"4\">\n\t\t\t\t\t<a-button type=\"primary\" @click=\"AddUserVisible = true\">新增</a-button>\n\t\t\t\t</a-col>\n\t\t\t</a-row>\n\t\t\t<a-table\n\t\t\t\t:columns='columns' \n\t\t\t\trowKey='ID'\n\t\t\t\t:pagination=\"pagination\"\n\t\t\t\t:dataSource=\"userlist\"\n\t\t\t\tbordered\n\t\t\t\t@change=\"handleTableChange\"\n\t\t\t>\n\t\t\t<span slot=\"role\" slot-scope=\"role\">{{role == 1 ? \"管理员\":\"订阅者\"}}</span>\n\t\t\t<template slot=\"action\" slot-scope=\"data\">\n\t\t\t\t<div class=\"actionSlot\">\n\t\t\t\t<a-button type=\"info\" icon=\"info\" style=\"margin-right:15px\" @click=\"ChangePassword(data.ID)\">修改密码</a-button>\n\t\t\t\t<a-button type=\"primary\" icon=\"edit\" style=\"margin-right:15px\" @click=\"editUser(data.ID)\">编辑</a-button>\n\t\t\t\t<a-popconfirm title=\"确认删除？删除后无法恢复\" ok-text=\"确认\" cancel-text=\"取消\" @confirm=\"delUser(data.ID)\">\n\t\t\t\t  <a-button icon=\"delete\" type=\"danger\">删除</a-button>\n\t\t\t\t</a-popconfirm>\n\t\t\t</div>\n\t\t\t</template>\n\t\t\t</a-table>\n\t\t</a-card>\n\t\t\n\t\t<!-- 新增用户对话框 -->\n\t\t<a-modal\n      title=\"新增用户\"\n      :visible=\"AddUserVisible\"\n      @ok=\"AddUserOk\"\n      @cancel=\"addUserCanal\"\n\t\t\tclosable\n    >\n      <a-form-model :model=\"userinfo\" :rules=\"userRules\" ref=\"addUserRef\">\n\t\t\t\t<a-form-model-item label=\"用户名\" prop=\"username\">\n\t\t\t\t\t<a-input v-model=\"userinfo.username\"></a-input>\n\t\t\t\t</a-form-model-item>\n\t\t\t\t<a-form-model-item label=\"密码\" prop=\"password\">\n\t\t\t\t\t<a-input-password v-model=\"userinfo.password\">\n\n\t\t\t\t\t</a-input-password>\n\t\t\t\t</a-form-model-item>\n\t\t\t\t<a-form-model-item label=\"确认密码\" prop=\"checkpass\">\n\t\t\t\t\t<a-input-password v-model=\"userinfo.checkpass\">\n\n\t\t\t\t\t</a-input-password>\n\t\t\t\t</a-form-model-item>\n\t\t\t\t\n\t\t\t</a-form-model>\n    </a-modal>\n\n\t\t<!-- 编辑用户 -->\n\t\t<a-modal\n      title=\"编辑用户\"\n      :visible=\"editUserVisible\"\n      @ok=\"editUserOk\"\n\t\t\twidth=\"60%\"\n      @cancel=\"editUserCanal\"\n\t\t\tclosable\n    >\n      <a-form-model :model=\"userinfo\" :rules=\"userRules\" ref=\"addUserRef\">\n\t\t\t\t<a-form-model-item label=\"用户名\" prop=\"username\">\n\t\t\t\t\t<a-input v-model=\"userinfo.username\"></a-input>\n\t\t\t\t</a-form-model-item>\n\n\t\t\t\t<a-form-model-item label=\"是否为管理员\">\n          <a-switch\n            :checked=\"IsAdmin\"\n            checked-children=\"是\"\n            un-checked-children=\"否\"\n            @change=\"adminChange\"\n          />\n        </a-form-model-item>\n\t\t\t\t\n\t\t\t</a-form-model>\n    </a-modal>\n\n\t\t<!-- 编辑密码 -->\n\t\t<a-modal\n      closable\n      title=\"修改密码\"\n      :visible=\"changePasswordVisible\"\n      width=\"60%\"\n      @ok=\"changePasswordOk\"\n      @cancel=\"changePasswordCancel\"\n      destroyOnClose\n    >\n      <a-form-model :model=\"userinfo\" :rules=\"userRules\" ref=\"addUserRef\">\n        <a-form-model-item has-feedback label=\"密码\" prop=\"password\">\n          <a-input-password v-model=\"userinfo.password\"></a-input-password>\n        </a-form-model-item>\n        <a-form-model-item has-feedback label=\"确认密码\" prop=\"checkpass\">\n          <a-input-password v-model=\"userinfo.checkpass\"></a-input-password>\n        </a-form-model-item>\n      </a-form-model>\n    </a-modal>\n\n\t</div>\n</template>\n\n<script>\nconst columns = [\n\t{\n    title: 'ID',\n    dataIndex: 'ID',\n    key: 'id',\n    width: '10%',\n\t\talign:'center'\n  },\n\t{\n    title: '用户名',\n    dataIndex: 'username',\n    key: 'username',\n    width: '20%',\n\t\talign:'center'\n  },\n\t{\n    title: '角色',\n    dataIndex: 'role',\n    key: 'role',\n    width: '20%',\n\t\tscopedSlots:{customRender:'role'},\n\t\talign:'center'\n  },\n\t{\n    title: '操作',\n    key: 'action',\n    width: '30%',\n\t\tscopedSlots:{customRender:'action'},\n\t\talign:'center'\n  },\n]\nexport default {\n\tdata(){\n\t\treturn{\n\t\t\tcolumns,\n\t\t\tchangePasswordVisible: false,\n\t\t\t// 分页\n\t\t\tpagination: {\n        pageSizeOptions: ['5', '10', '20'],\n        pageSize: 5,\n        total: 0,\n        showSizeChanger: true,\n        showTotal: (total) => `共${total}条`,\n      },\n\t\t\tqueryParam: {\n\t\t\t\tusername:'',\n        pagesize: 5,\n        pagenum: 1,\n      },\n\t\t\tuserlist:[],\n\t\t\tAddUserVisible:false,\n\t\t\teditUserVisible:false,\n\t\t\tuserinfo:{\n\t\t\t\tid:0,\n\t\t\t\tusername:'',\n\t\t\t\tpassword:'',\n\t\t\t\tcheckpass:'',\n\t\t\t\trole:2\n\t\t\t},\n\t\t\tuserRules:{\n\t\t\t\tusername: [\n          {\n            validator: (rule, value, callback) => {\n              if (this.userinfo.username == '') {\n                callback(new Error('请输入用户名'))\n              }\n              if ([...this.userinfo.username].length < 4 || [...this.userinfo.username].length > 12) {\n                callback(new Error('用户名应当在4到12个字符之间'))\n              } else {\n                callback()\n              }\n            },\n            trigger: 'blur',\n          },\n        ],\n        password: [\n          {\n            validator: (rule, value, callback) => {\n              if (this.userinfo.password == '') {\n                callback(new Error('请输入密码'))\n              }\n              if ([...this.userinfo.password].length < 6 || [...this.userinfo.password].length > 20) {\n                callback(new Error('密码应当在6到20位之间'))\n              } else {\n                callback()\n              }\n            },\n            trigger: 'blur',\n          },\n        ],\n\t\t\t\tcheckpass: [\n          {\n            validator: (rule, value, callback) => {\n              if (this.userinfo.checkpass == '') {\n                callback(new Error('请输入密码'))\n              }\n              if (this.userinfo.password !== this.userinfo.checkpass) {\n                callback(new Error('密码不一致，请重新输入'))\n              } else {\n                callback()\n              }\n            },\n            trigger: 'blur',\n          },\n        ],\n\n\n\n\t\t\t},\n\t\t}\n\t},\n\tcreated(){\n\t\tthis.getUserList()\n\t},\n\tcomputed: {\n\t\t// 加载前布尔判断\n    IsAdmin: function () {\n      if (this.userinfo.role === 1) {\n        return true\n      } else {\n        return false\n      }\n    }\n\t},\n\tmethods:{\n\t\t// 查询用户\n\t\tasync getUserList(){\n\t\t\tconst { data:res } = await this.$http.get('api/v1/user/', {\n\t\t\t\tparams:{\n\t\t\t\t\tusername: this.queryParam.username,\n\t\t\t\t\tsize: this.queryParam.pagesize,\n\t\t\t\t\tpage: this.queryParam.pagenum,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\tif(res.code != 200)return this.$message.error(res.msg)\n\t\t\tthis.userlist = res.data\n\t\t\tthis.pagination.total = res.total\n\t\t},\n\t\t// 分页\n\t\thandleTableChange(pagination, filters, sorter) {\n      var pager = { ...this.pagination }\n      pager.current = pagination.current\n      pager.pageSize = pagination.pageSize\n      this.queryParam.pagesize = pagination.pageSize\n      this.queryParam.pagenum = pagination.current\n\n      if (pagination.pageSize !== this.pagination.pageSize) {\n        this.queryParam.pagenum = 1\n        pager.current = 1\n      }\n      this.pagination = pager\n      this.getUserList()\n    },\n\t\t// 删除用户\n\t\tasync delUser(id){\n\t\t  const { data: res } = await this.$http.delete(`api/admin/user/${id}/`)\n\t\t\tif(res.code != 200)return this.$message.error(res.msg)\n\t\t\tthis.queryParam.pagenum = 1\n\t\t\tthis.$message.success('删除成功')\n\t\t\tthis.getUserList()\n\t\t},\n\n\t\tAddUserOk(){\n\t\t\tthis.$refs.addUserRef.validate(async (vaild)=>{\n\t\t\t\tif(!vaild)return this.$message.error(\"格式不正确\")\n\t\t\t\tconst { data: res } = await this.$http.post(\"api/v1/user/\",{\n\t\t\t\t\t\"username\":this.userinfo.username,\n\t\t\t\t\t\"password\":this.userinfo.password,\n\t\t\t\t\t\"role\": this.userinfo.role,\n\t\t\t\t\t})\n\t\t\t\tif (res.code != 200) return this.$message.error(res.msg)\n\t\t\t\t// 清空搜索框\n\t\t\t\tthis.$refs.addUserRef.resetFields()\n\t\t\t\t// 关闭弹窗\n        this.AddUserVisible = false\n        this.$message.success('添加用户成功')\n        this.getUserList()\n\t\t\t})\n\t\t},\n\t\t// role布尔值判断\n\t\tadminChange(checked){\n      if (checked) {\n        this.userinfo.role = 1\n      } else {\n        this.userinfo.role = 2\n      }\n\t\t},\n\t\t// 取消的方法\n\t\taddUserCanal(){\n\t\t\tthis.$refs.addUserRef.resetFields()\n\t\t\tthis.AddUserVisible = false\n\t\t},\n\t\t// 编辑框获取用户信息\n\t\tasync editUser(id){\n\t\t\tthis.editUserVisible = true\n\t\t\tconst {data: res } = await this.$http.get(`/api/v1/user/${id}/`)\n\t\t\tthis.userinfo = res.data\n\t\t\tthis.userinfo.id = id\n\t\t},\n\t\t// 编辑用户\n\t\teditUserOk(){\n\t\t\tthis.$refs.addUserRef.validate(async (vaild)=>{\n\t\t\t\tif(!vaild)return this.$message.error(\"格式不正确\")\n\t\t\t\tconst { data: res } = await this.$http.put(`/api/admin/user/${this.userinfo.id}/`,{\n\t\t\t\t\t\"username\":this.userinfo.username,\n\t\t\t\t\t\"role\": this.userinfo.role,\n\t\t\t\t\t})\n\t\t\t\tif (res.code != 200) return this.$message.error(res.msg)\n\t\t\t\t// 清空搜索框\n\t\t\t\tthis.$refs.addUserRef.resetFields()\n\t\t\t\t// 关闭弹窗\n        this.editUserVisible = false\n        this.$message.success('编辑用户成功')\n        this.getUserList()\n\t\t\t})\n\t\t},\n\t\t// 取消编辑销毁数据\n\t\teditUserCanal(){\n\t\t\tthis.$refs.addUserRef.resetFields()\n\t\t\tthis.editUserVisible = false\n\t\t},\n\t\t// 修改密码获取信息\n\t\tChangePassword(id){\n\t\t\tthis.changePasswordVisible = true\n      this.userinfo.id = id\n\t\t},\n\t\t// 修改密码\n\t\tchangePasswordOk() {\n      this.$refs.addUserRef.validate(async (valid) => {\n        if (!valid) return this.$message.error('参数不符合要求，请重新输入')\n        const { data: res } = await this.$http.put(`/api/admin/editpass/${this.userinfo.id}/`,{\n\t\t\t\t\"password\":this.userinfo.password\n\t\t\t})\n        if (res.code != 200) return this.$message.error(res.msg)\n        this.changePasswordVisible = false\n        this.$message.success('修改密码成功')\n        this.getUserList()\n      })\n    },\n\t\t// 修改密码取消\n\t\tchangePasswordCancel() {\n      this.$refs.addUserRef.resetFields()\n      this.changePasswordVisible = false\n      this.$message.info('已取消')\n    },\n\n\n\t}\n\n}\n</script>\n\n<style>\n.actionSlot{\n\tdisplay: flex;\n\tjustify-content: center;\n}\n\n</style>"]}]}